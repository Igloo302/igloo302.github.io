<!DOCTYPE html>
<html lang="en-us">
  <head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="robots" content="noodp" />
  
  <meta name="author" content="Igloo">
  
  
  
  
  <link rel="prev" href="https://igloo302.github.io/2019/%E5%B0%8F%E5%BA%A6%E5%B0%8F%E8%8A%A6%E4%B8%80%E4%B8%AA%E4%BB%BF%E4%BD%9B%E6%9C%89%E7%82%B9%E8%84%91%E5%AD%90%E7%9A%84%E8%93%9D%E7%89%99%E9%9F%B3%E5%93%8D/" />
  
  <link rel="next" href="https://igloo302.github.io/2020/git%E7%BD%91%E7%BB%9C%E5%8A%A0%E9%80%9F-%E4%B8%BAgit%E8%AE%BE%E7%BD%AE%E4%BB%A3%E7%90%86/" />
  
  <script src="https://kit.fontawesome.com/3dd514082f.js" crossorigin="anonymous"></script>


  <link rel="canonical" href="https://igloo302.github.io/2020/724-%E6%96%90%E8%AE%AFn1%E7%9A%84%E6%97%81%E8%B7%AF%E7%94%B1%E7%8E%A9%E6%B3%95/" />
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">
  <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="theme-color" content="#ffffff">
  <title>
    
    
    7×24-斐讯N1的旁路由玩法 | 冰屋里
    
  </title>
  <meta name="title"
    content="7×24-斐讯N1的旁路由玩法 | 冰屋里">
    
  
  <link rel="stylesheet" href="/font/iconfont.css">
  <link rel="stylesheet" href="/css/main.min.css">


  
  
 

<script type="application/ld+json">
 "@context" : "http://schema.org",
    "@type" : "BlogPosting",
    "mainEntityOfPage": {
         "@type": "WebPage",
         "@id": "https:\/\/igloo302.github.io"
    },
    "articleSection" : "posts",
    "name" : "7×24-斐讯N1的旁路由玩法",
    "headline" : "7×24-斐讯N1的旁路由玩法",
    "description" : "N1是已经暴雷快两年的斐讯留下来的经典矿渣遗产。2GB RAM，四核心ARM SOC，4K 输出，千兆网口，读写30MB\x2b的USB 2.0，决定了N1绝不甘心当一个吃灰的挖矿机。在一众技术大佬的研究下，N1成功转型为电视盒子、NAS、下载机、高清播放器、复古游戏机，以及本文要介绍的旁路由。\n我们平时使用的家用路由器需要负责网关服务器、DHCP服务器、PPPOE拨号、DNS服务器、发射WIFI信号等工作，所谓旁路由（并不是专业的叫法，民间约定俗成）就是把这些功能中的一部分让渡给这台设备去处理。\n大多数的家用路由器的性能都是及其羸弱的，运行去广告、V2Ray、SS这种服务的时候难以发挥出最好的效果，有了一台旁路由，我们就可以把这些高难度任务交给它，让主路由安安心心地拨号、分配IP地址（DHCP）。连接方式如图：\n因为这个网络拓扑本质上实现了一次单线复用，所以也适用于弱电箱较小，无法容纳高性能网络设备的情况，比方说我就将N1放在了有网口的书房，同时打开N1的WiFi用于补足书房信号不足的问题。\n所需设备  正常运行的家庭网络 斐讯N1 双公头USB数据线（可使用两根没有的MicroUSB数据线DIY） 1GB以上U盘或TF卡\x2b读卡器（USB 2.0最佳） USB鼠标 显示器和HDMI线 刷机包，包括N1降级工具（链接: https:\/\/pan.baidu.com\/s\/11-7FbdmTDBTcb-qberyQLw 提取码: 6h3s）、OpenWRT固件 Windows或Mac电脑  N1降级 如果买到的N1版本高于2.19，则需要将boot、bootloader、recovery降级，简要步骤如下：\n 加电开机后用鼠标多次点击版本号，弹出Toast 「打开ADB」。 将N1连上Wifi或有线网络，记录IP地址 用双头USB线将N1和电脑相连 运行T1_N1降级工具v1.1.exe自动降级或手动刷入老版本boot、bootloader、recovery。  手动刷入方法：\n 打开adb所在文件夹，按住Shift同时右键空白处，点击「在此处打开Powershell窗口」 依次输入以下代码  # adb连接N1 .\\adb.exe connect 192.168.x.xxx # 重启到fastboot .\\adb.exe reboot fastboot # 刷入boot、bootloader、recovery fastboot flash boot .\\N1\\N1boot.img fastboot flash bootloader .\\N1\\N1bootloader.img fastboot flash recovery .\\N1\\N1recovery.img 安装OpenWRT 目前有2种方式安装OpenWRT\/LEDE，分别为\n 安装Armbian系统，在Docker（可以理解为虚拟机）中安装OpenWRT 只安装OpenWRT  同时，两种安装方式都可以通过线刷和U盘刷\/卡刷两种方式刷入N1。\n因为笔者不只需要这台旁路由安安静静地负责单纯翻墙和去广告工作，所以选择只安装OpenWRT，固件采用的是flippy编译的OP，这个固件编译lean \x26amp; lienol维护的源码。",
    "inLanguage" : "en-us",
    "author" : "Igloo",
    "creator" : "Igloo",
    "publisher": "Igloo",
    "accountablePerson" : "Igloo",
    "copyrightHolder" : "Igloo",
    "copyrightYear" : "2020",
    "datePublished": "2020-02-24 14:38:04 \x2b0000 UTC",
    "dateModified" : "2020-02-24 14:38:04 \x2b0000 UTC",
    "url" : "https:\/\/igloo302.github.io\/2020\/724-%E6%96%90%E8%AE%AFn1%E7%9A%84%E6%97%81%E8%B7%AF%E7%94%B1%E7%8E%A9%E6%B3%95\/",
    "wordCount" : "111",
    "keywords" : [ "斐讯","路由器","Phicomm","N1","7×24", "冰屋里"]
}
</script>

</head>



  <body class="">
    <div class="wrapper">
        <nav class="navbar">
    <div class="container">
        <div class="navbar-header header-logo">
        	<a href="javascript:void(0);" class="theme-switch"><i class="iconfont icon-xihuan"></i></a>&nbsp;<a href="https://igloo302.github.io">冰屋里</a>
        </div>
        <div class="menu navbar-right">
                
                
                <a class="menu-item" href="/posts/" title="">Blog</a>
                
                <a class="menu-item" href="/portfolio/" title="">Portfolio</a>
                
                <a class="menu-item" href="/categories/" title="">Categories</a>
                
                <a class="menu-item" href="/tags/" title="">Tags</a>
                
                <a class="menu-item" href="/about/" title="">About</a>
                
        </div>
    </div>
</nav>
<nav class="navbar-mobile" id="nav-mobile" style="display: none">
     <div class="container">
        <div class="navbar-header">
            <div>  <a href="javascript:void(0);" class="theme-switch"><i class="iconfont icon-xihuan"></i></a>&nbsp;<a href="https://igloo302.github.io">冰屋里</a></div>
            <div class="menu-toggle">
                <span></span><span></span><span></span>
            </div>
        </div>
     
          <div class="menu" id="mobile-menu">
                
                
                <a class="menu-item" href="/posts/" title="">Blog</a>
                
                <a class="menu-item" href="/portfolio/" title="">Portfolio</a>
                
                <a class="menu-item" href="/categories/" title="">Categories</a>
                
                <a class="menu-item" href="/tags/" title="">Tags</a>
                
                <a class="menu-item" href="/about/" title="">About</a>
                
        </div>
    </div>
</nav>
    	 <main class="main">
          <div class="container">
          
<article class="post-warp" itemscope itemtype="http://schema.org/Article">
    <header class="post-header">
        <h1 class="post-title" itemprop="name headline">7×24-斐讯N1的旁路由玩法</h1>
        <div class="post-meta">
            Written by <a itemprop="name" href="https://igloo302.github.io"
                rel="author">Igloo</a>
            with ♥
            <span class="post-time">
                on <time datetime=2020-02-24
                    itemprop="datePublished">February 24, 2020</time>
            </span>
            in
            <i class="iconfont icon-folder"></i>
            <span class="post-category">
                <a href="https://igloo302.github.io/categories/724/"> 7×24 </a>
                
            </span>
        </div>
    </header>
    <div class="post-content">
        

        
        
        

        
        

        
        
        

        
        
        

        <p>N1是已经暴雷快两年的斐讯留下来的经典矿渣遗产。2GB RAM，四核心ARM SOC，4K 输出，千兆网口，读写30MB+的USB 2.0，决定了N1绝不甘心当一个吃灰的挖矿机。在一众技术大佬的研究下，N1成功转型为电视盒子、NAS、下载机、高清播放器、复古游戏机，以及本文要介绍的旁路由。</p>
<!-- more -->
<p>我们平时使用的家用路由器需要负责网关服务器、DHCP服务器、PPPOE拨号、DNS服务器、发射WIFI信号等工作，所谓旁路由（并不是专业的叫法，民间约定俗成）就是把这些功能中的一部分让渡给这台设备去处理。</p>
<p>大多数的家用路由器的性能都是及其羸弱的，运行去广告、V2Ray、SS这种服务的时候难以发挥出最好的效果，有了一台旁路由，我们就可以把这些高难度任务交给它，让主路由安安心心地拨号、分配IP地址（DHCP）。连接方式如图：</p>
<p><img src="http://img.osland.me/static/images/%E6%97%81%E8%B7%AF%E7%94%B1%E7%BD%91%E7%BB%9C%E6%8B%93%E6%89%91.png" alt="旁路由网络拓扑"></p>
<p>因为这个网络拓扑本质上实现了一次单线复用，所以也适用于弱电箱较小，无法容纳高性能网络设备的情况，比方说我就将N1放在了有网口的书房，同时打开N1的WiFi用于补足书房信号不足的问题。</p>
<h2 id="所需设备">所需设备</h2>
<ul>
<li>正常运行的家庭网络</li>
<li>斐讯N1</li>
<li>双公头USB数据线（可使用两根没有的MicroUSB数据线DIY）</li>
<li>1GB以上U盘或TF卡+读卡器（USB 2.0最佳）</li>
<li>USB鼠标</li>
<li>显示器和HDMI线</li>
<li>刷机包，包括N1降级工具（链接: <a href="https://pan.baidu.com/s/11-7FbdmTDBTcb-qberyQLw">https://pan.baidu.com/s/11-7FbdmTDBTcb-qberyQLw</a> 提取码: 6h3s）、<a href="https://www.right.com.cn/forum/forum.php?mod=viewthread&amp;tid=981406&amp;extra=page%3D1%26filter%3Dtypeid%26typeid%3D21">OpenWRT固件</a></li>
<li>Windows或Mac电脑</li>
</ul>
<h2 id="n1降级">N1降级</h2>
<p>如果买到的N1版本高于2.19，则需要将boot、bootloader、recovery降级，简要步骤如下：</p>
<ol>
<li>加电开机后用鼠标多次点击版本号，弹出Toast 「打开ADB」。</li>
<li>将N1连上Wifi或有线网络，记录IP地址</li>
<li>用双头USB线将N1和电脑相连</li>
<li>运行T1_N1降级工具v1.1.exe自动降级或手动刷入老版本boot、bootloader、recovery。</li>
</ol>
<p>手动刷入方法：</p>
<ol>
<li>打开adb所在文件夹，按住Shift同时右键空白处，点击「在此处打开Powershell窗口」</li>
<li>依次输入以下代码</li>
</ol>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell"><span style="color:#75715e"># adb连接N1</span>
.\adb.exe connect 192.168.x.xxx
    
<span style="color:#75715e"># 重启到fastboot</span>
.\adb.exe reboot fastboot
    
<span style="color:#75715e"># 刷入boot、bootloader、recovery</span>
fastboot flash boot .\N1\N1boot.img
fastboot flash bootloader .\N1\N1bootloader.img
fastboot flash recovery .\N1\N1recovery.img 
</code></pre></div><h2 id="安装openwrt">安装OpenWRT</h2>
<p>目前有2种方式安装OpenWRT/LEDE，分别为</p>
<ol>
<li>安装Armbian系统，在Docker（可以理解为虚拟机）中安装OpenWRT</li>
<li>只安装OpenWRT</li>
</ol>
<p>同时，两种安装方式都可以通过线刷和U盘刷/卡刷两种方式刷入N1。</p>
<p>因为笔者不只需要这台旁路由安安静静地负责单纯翻墙和去广告工作，所以选择只安装OpenWRT，固件采用的是flippy编译的<a href="https://www.right.com.cn/forum/forum.php?mod=viewthread&amp;tid=981406&amp;extra=page%3D1%26filter%3Dtypeid%26typeid%3D21">OP</a>，这个固件编译lean  &amp;  lienol维护的源码。</p>
<p>下载固件用USB Image Tool刷入U盘，N1重启进入原生的NAS系统，将U盘插入N1后使用Adb命令重启：</p>
<pre><code>.\adb.exe connect 192.168.x.xxx
.\adb.exe shell reboot update
</code></pre><p>此时将N1和电脑通过网线连接，SSH访问<code>192.168.1.1</code>，用户为<code>root</code>，密码为<code>password</code>。</p>
<p><img src="http://img.osland.me/static/images/sshop.jpg" alt="sshop"></p>
<p>输入以下命令开始将OpenWRT安装到N1的EMMC（内置存储）中</p>
<pre><code>cd /root
 ./inst-to-emmc.sh
</code></pre><p>等到SSH显示<code>All done, please reboot!</code>时OP就刷好了，拔掉U盘后重启就可以启动OpenWRT了。</p>
<h2 id="设置旁路由">设置旁路由</h2>
<p>我的目标是旁路由负责网关和DNS，主路由负责拨号和DHCP，这样所有的外网流量都会从N1走，就能进行翻墙和去广告了。</p>
<h3 id="设置-n1">设置 N1</h3>
<p>依旧PC直连N1，进入<code>192.168.1.1</code>，密码为<code>password</code>，进入「网络」-「接口」，编辑LAN设置，按照下图设置。</p>
<p><img src="http://img.osland.me/static/images/n1lan.png" alt=""></p>
<p>勘误：将自定义DNS服务器设置成192.168.6.1</p>
<p>同时关闭DHCP「忽略此接口」</p>
<p><img src="http://img.osland.me/static/images/n1lan2.png" alt="n1lan2"></p>
<p>保存&amp;应用修改。</p>
<h3 id="设置主路由">设置主路由</h3>
<p>将N1连接到主路由的LAN上，进入主路由后台进入<code>192.168.6.1</code>，我使用的是高恪，进入「网络设置」-「DHCP」，将网关和主DNS修改为<code>192.168.6.2</code>（旁路由N1的IP）</p>
<p><img src="http://img.osland.me/static/images/router.png" alt="router"></p>
<p>如果主路由是OpenWRT的话，在「网络」-「接口」-「LAN」-「DHCP 服务器」-「高级设置」，在「DHCP 选项」中，添加两条参数，<code>3,192.168.6.2</code>（表示网关指向N1），<code>6,192.168.6.2</code> （表示DNS指向N1），可以达到相同的效果。</p>
<p>最后，在防火墙设置中添加<code>iptables -t nat -I POSTROUTING -o eth0 -j MASQUERADE</code>。</p>
<p><img src="http://img.osland.me/static/images/netinfo.png" alt="netinfo"></p>
<p>查看当前的连接信息，默认网关和DNS服务器都为<code>192.168.6.2</code>即宣告成功。至此，N1旁路由就设置好了，进入<code>192.168.6.2</code>去配置翻墙吧。</p>
<h2 id="关于724">关于7×24</h2>
<p>本篇为7×24的第一篇。这将会组成一个系列企划，试图回答问题——「一台7×24小时运行的电脑可以用来做什么？」</p>
<p>一台可以持续运行（低功耗）又功能强大（高性能）的计算机越来越容易获取。从Android手机到电视盒子，从NAS到闲置的x86家用电脑，以ARM和Linux为核心的计算机已经遍布我们的生活，我将以「不折腾，毋宁死」的精神，发掘各种小电脑的玩法。</p>
<p>这并不是什么新鲜话题，在其他的平台、Blog个中，都已经有崭新的「轮子」。与其说是分享，不如称为出于兴趣的记录。因此，文中会尽量给出相关文章和引用出处，只给出最关键的内容。</p>
<p>完毕。</p>

    </div>

    <div class="post-copyright">
        
        <p class="copyright-item">
            <span>Author:</span>
            <span>Igloo </span>
        </p>
        

        
        <p class="copyright-item">
            <span>Link:</span>
            <a href=https://igloo302.github.io/2020/724-%E6%96%90%E8%AE%AFn1%E7%9A%84%E6%97%81%E8%B7%AF%E7%94%B1%E7%8E%A9%E6%B3%95/>https://igloo302.github.io/2020/724-%E6%96%90%E8%AE%AFn1%E7%9A%84%E6%97%81%E8%B7%AF%E7%94%B1%E7%8E%A9%E6%B3%95/</span>
        </p>

        
        
    </div>



    <div class="post-tags">
        
        <section>
            <i class="iconfont icon-tag"></i>Tag(s):
            
            <span class="tag"><a href="https://igloo302.github.io/tags/%E6%96%90%E8%AE%AF/">
                    #斐讯</a></span>
            
            <span class="tag"><a href="https://igloo302.github.io/tags/%E8%B7%AF%E7%94%B1%E5%99%A8/">
                    #路由器</a></span>
            
            <span class="tag"><a href="https://igloo302.github.io/tags/phicomm/">
                    #Phicomm</a></span>
            
            <span class="tag"><a href="https://igloo302.github.io/tags/n1/">
                    #N1</a></span>
            
            <span class="tag"><a href="https://igloo302.github.io/tags/724/">
                    #7×24</a></span>
            
        </section>
        
        <section>
            <a href="javascript:window.history.back();">back</a></span> ·
            <span><a href="https://igloo302.github.io">home</a></span>
        </section>
    </div>

    <div class="post-nav">
        
        <a href="https://igloo302.github.io/2019/%E5%B0%8F%E5%BA%A6%E5%B0%8F%E8%8A%A6%E4%B8%80%E4%B8%AA%E4%BB%BF%E4%BD%9B%E6%9C%89%E7%82%B9%E8%84%91%E5%AD%90%E7%9A%84%E8%93%9D%E7%89%99%E9%9F%B3%E5%93%8D/" class="prev" rel="prev" title="小度小芦，一个仿佛有点脑子的蓝牙音响"><i
                class="iconfont icon-left"></i>&nbsp;小度小芦，一个仿佛有点脑子的蓝牙音响</a>
        
        
        <a href="https://igloo302.github.io/2020/git%E7%BD%91%E7%BB%9C%E5%8A%A0%E9%80%9F-%E4%B8%BAgit%E8%AE%BE%E7%BD%AE%E4%BB%A3%E7%90%86/" class="next" rel="next"
            title="Git网络加速|为Git设置代理">Git网络加速|为Git设置代理&nbsp;<i class="iconfont icon-right"></i></a>
        
    </div>

    <div class="post-comment">
        
        
        
        
        
        <div id="vcomments"></div>
        <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
        <script src='//unpkg.com/valine/dist/Valine.min.js'></script>
        <script type="text/javascript">
          new Valine({
            el: '#vcomments',
            appId: 'SIOuMPbRjrVKLs1aBbSS30Ne-gzGzoHsz',
            appKey: 'uv74bsFWliyb0LPw2XV8MIjM',
            notify:  false ,
            verify:  false ,
            avatar: 'mm',
            placeholder: 'Mann Tracht, Un Gott Lacht.',
            visitor:  true 
            });
        </script>
        
    </div>
</article>
          </div>
       </main>      
      <footer class="footer">
    <div class="copyright">
        &copy;
        
        <span itemprop="copyrightYear">2016 - 2020</span>
        
        <span class="with-love">
    	 <i class="iconfont icon-love"></i> 
         </span>
         
            <span class="author" itemprop="copyrightHolder"><a href="https://igloo302.github.io">Igloo</a> | </span> 
         

         
		  <span>Powered by <a href="https://gohugo.io/" target="_blank" rel="external nofollow">Hugo</a> & <a href="https://github.com/liuzc/leaveit" target="_blank" rel="external nofollow">LeaveIt</a></span> 
    </div>
</footer>












    
     <link href="//lib.baomitu.com/lightgallery/1.6.11/css/lightgallery.min.css" rel="stylesheet">  
      
     <script src="/js/vendor_gallery.min.js" async="" ></script>
    
  



     </div>
  </body>
</html>
